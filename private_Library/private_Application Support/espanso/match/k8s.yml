# yaml-language-server: $schema=https://raw.githubusercontent.com/espanso/espanso/dev/schemas/match.schema.json
matches:
  - trigger: ":kubedebug"
    label: run a debug pod
    replace: "kubectl run debug -i --tty --image wbitt/network-multitool --rm -n default -- /bin/bash"

  - trigger: ":kgn"
    label: get pods running on a specific node
    replace: "kubectl get pods --all-namespaces -o wide --field-selector spec.nodeName="

  - trigger: ":kexec"
    replace: "kubectl exec -it {{clipb}} -n $|$ -- bash"
    vars:
      - name: "clipb"
        type: "clipboard"

  - trigger: ":kclean"
    replace: "echo > ~/.kube/config"

  - trigger: "::kgetallwarning"
    replace: kubectl get events -w --field-selector=type=Warning -A
    label: get all warninigs events from all namespaces

  - trigger: "::kgetsecret"
    replace: kubectl get secret $|$ -n namespace -o go-template='{{range $k,$v := .data}}{{"export "}}{{$k}}{{"="}}{{$v|base64decode}}{{"\n"}}{{end}}'
    label: kubectl get secret decoded

  - trigger: ":kdrain"
    replace: "kubectl drain {{ clipb }} --delete-emptydir-data --ignore-daemonsets"
    vars:
      - name: "clipb"
        type: "clipboard"
